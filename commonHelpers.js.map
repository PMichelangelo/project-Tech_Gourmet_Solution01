{"version":3,"file":"commonHelpers.js","sources":["../src/js/createCartMarkup.js","../src/img/shopping-basket.png","../src/js/cartProducts.js","../src/js/cartPage.js"],"sourcesContent":["import icons from '../img/icons.svg';\n\nexport function cartOrder(arr) {\n  return arr\n    .map(\n      ({ _id, img, name, price, category, size }) => `\n  <li class=\"cart-order-item\" data-id=\"${_id}\">\n    <div class=\"cart-item-content\">\n      <div class=\"cart-order-img-cont\">\n        <img\n          class=\"cart-order-img\"\n          src=\"${img}\"\n          alt=\"${name}\"\n          loading=\"lazy\"\n        />\n      </div>\n      <div class=\"cart-order-desc\">\n        <div class=\"cart-order-title-btn\">\n          <h3 class=\"cart-order-title\">${name}</h3>\n          <button class=\"cart-remove-btn\" type=\"button\" height=\"18\" title='close' aria-label=\"close\">\n            <span class=\"cart-remove-span\">\n              <svg class=\"cart-remove-icon\" width=\"18\" height=\"18\">\n                <use\n                  class=\"cart-remove-svg\"\n                  xlink:href=\"${icons}#icon-close-btn\"\n                ></use>\n              </svg>\n            </span>\n          </button>\n        </div>\n        <p class=\"cart-order-text\">\n          <span class=\"cart-order-span\">Category:</span>${category\n            .replace('_', ' ')\n            .replace('_', ' ')}\n          <span class=\"cart-order-span cart-gap\">Size:</span>\n          ${size.replace('oz', 'g')}\n        </p>\n        <div class=\"cart-order-total-price\">\n\n          <div class=\"cart-order-amount\">\n            <button class=\"cart-order-decr\" type=\"button\"><svg class=\"minus-icon\" width=\"18\" height=\"18\" title='back' aria-label=\"back\">\n                <use\n                  class=\"cart-remove-svg\"\n                  xlink:href=\"\"\n                ></use>\n              </svg></button>\n            <span class=\"cart-order-quantity\">$${price}</span>\n            <button class=\"cart-order-incr\" type=\"button\"><svg class=\"plus-icon\" width=\"18\" height=\"18\" title='forward' aria-label=\"forward\">\n                <use\n                  class=\"cart-remove-svg\"\n                  xlink:href=\"\"\n                ></use>\n              </svg></button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </li>\n  `\n    )\n    .join('');\n}\n","export default \"__VITE_ASSET__20e157b6__\"","import { getServerProductsById } from './fetchProducts';\nimport { cartOrder } from './createCartMarkup';\nimport shoppingBasket from '../img/shopping-basket.png'\n\n\nconst emptyCart = document.querySelector('.cart-empty'),\n  cartListTotal = document.querySelector('.cart-list-total'),\n  cartOrderList = document.querySelector('.cart-order-list');\n\nexport function nullCart() {\n  emptyCart.insertAdjacentHTML(\n    'beforeend',\n    `<div class=\"cart-empty-desc\">\n            <img\n              src=\"${shoppingBasket}\"\n              srcset=\"\"\n              alt=\"Shopping Basket\"\n              loading=\"lazy\"\n            />\n            <h2>Your basket is <span class=\"cart-empty-cgreen\">empty...</span></h2>\n            <p class=\"cart-empty-text\">\n              Go to the main page to select your favorite products and add them to the\n              cart.\n            </p>\n          </div>\n        `\n  );\n  cartListTotal.classList.add('visually-hidden');\n}\nasync function getCardProducts(productsList) {\n  if (!productsList.length) {\n    nullCart();\n  }\n\n  try {\n    const products = await Promise.all(\n      productsList.map(productId => getServerProductsById(productId))\n    );\n    const cartMarkup = cartOrder(products);\n    cartOrderList.insertAdjacentHTML('afterbegin', cartMarkup);\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nasync function calculateTotalPrice() {\n  const cartDataString = localStorage.getItem('cartData');\n  if (!cartDataString) {\n    return 0;\n  }\n  const cartData = JSON.parse(cartDataString);\n  const productIds = Object.values(cartData);\n  let totalPrice = 0;\n  for (const productId of productIds) {\n    try {\n      const result = await getServerProductsById(productId);\n\n      totalPrice += result.price;\n    } catch (error) {\n      console.error(\n        `Error fetching product with id ${productId}: ${error.message}`\n      );\n    }\n  }\n  return +totalPrice.toFixed(2);\n}\n\nasync function updateTotalPrice() {\n  const totalPrice = await calculateTotalPrice();\n  const totalPriceSpan = document.getElementById('cart_total');\n  totalPriceSpan.textContent = `$${totalPrice}`;\n}\n\nexport {\n  getCardProducts,\n  calculateTotalPrice,\n  updateTotalPrice\n};\n","import { getCardProducts } from './cartProducts';\nimport { initCartStorage } from './cartStorage';\nimport { updateCartCounterOnLoad } from './updateCartCounter';\nimport { updateTotalPrice } from './cartProducts';\nimport { openCardPageModal } from './modal';\nimport { calculateTotalPrice } from './cartProducts';\nimport { nullCart } from './cartProducts';\nimport { removeFromCart } from './cartStorage';\nimport { getServerProductsById } from './fetchProducts';\nimport { onSubmit } from './subscribeEmail';\nimport axios from 'axios';\n\n// Рахуємо загальну суму покупки\nconst total = document.getElementById('cart_total');\ncalculateTotalPrice().then(data => (total.textContent = `$${data}`));\n\nconst cartList = document.querySelector('.cart-order-list');\n\ncartList.addEventListener('click', removeProduct);\n\nfunction removeProduct(event) {\n  const cartEl = event.target.closest('.cart-order-item');\n\n  const removeBtn = event.target.closest('.cart-remove-span');\n\n  if (cartEl) {\n    const productId = cartEl.getAttribute('data-id');\n\n    if (removeBtn) {\n      removeFromCart(productId);\n      updateCartCounterOnLoad();\n\n       cartEl.style.opacity = '0';\n      function none() {\n        cartEl.style.display = 'none';\n      }\n\n      setTimeout(none, 500);\n\n      calculateTotalPrice().then(data => (total.textContent = `$${data}`));\n\n      const storage = JSON.parse(localStorage.getItem('cartData'));\n      if (!storage.length) {\n        nullCart();\n      }\n    }\n  }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  updateCartCounterOnLoad();\n  updateTotalPrice();\n  initCartStorage();\n\n  const cartProductsList = JSON.parse(localStorage.getItem('cartData'));\n  getCardProducts(cartProductsList);\n\n  const clearAllBtn = document.querySelector('.cart-clear-btn');\n\n  clearAllBtn.addEventListener('click', () => {\n    document.querySelector('.cart-order-list').innerHTML = '';\n\n    localStorage.setItem('cartData', JSON.stringify([]));\n\n    updateCartCounterOnLoad();\n\n    const cartsTotal = document.querySelector('.cart-list-total');\n    cartsTotal.style.opacity = '0';\n    setTimeout(nullCart, 350);\n  });\n});\n\n\nconst form = document.querySelector('.cart_checkout');\nconst button = document.querySelector('.cart_checkout_btn');\n\n\nform.addEventListener('submit', senndForm);\nlet emailOut;\nlet order;\nasync function senndForm(event) {\n  event.preventDefault();\n  let findproduct = JSON.parse(localStorage.getItem('cartData'));\n  const emailInput = document.querySelector('.cart-basket-input');\n  emailOut = emailInput.value.trim();\n  const pattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n  if (!pattern.test(emailOut)) {\n    return alert('Please enter the correct email!');\n  }\n\n  const foodItems = await Promise.all(\n    findproduct.map(productId => getServerProductsById(productId))\n  );\n  const transformedData = foodItems.map(item => {\n    return {\n      productId: item._id,\n      amount: item.price,\n    };\n  });\n  order = transformedData;\n\n  form.reset();\n  sendFormData(order);\n}\n\nfunction sendFormData(order) {\n  const serverUrl = 'https://food-boutique.b.goit.study/api/orders';\n\n  const formData = {\n    email: emailOut,\n    products: order,\n  };\n\n  axios\n    .post(serverUrl, formData)\n    .then(response => {\n      openCardPageModal();\n      nullCart();\n      document.querySelector('.cart-order-list').innerHTML = '';\n\n      localStorage.setItem('cartData', JSON.stringify([]));\n\n      updateCartCounterOnLoad();\n    })\n    .catch(error => {\n      alert(\n        'An error occurred while attempting the requested operation. Please check the entered data and try again. If the issue persists, contact customer support.'\n      );\n    });\n}\n\nconst emailFInput = document.querySelector('.footer-submit-btn');\nemailFInput.addEventListener('click', onSubmit);\n"],"names":["cartOrder","arr","_id","img","name","price","category","size","icons","shoppingBasket","emptyCart","cartListTotal","cartOrderList","nullCart","getCardProducts","productsList","products","productId","getServerProductsById","cartMarkup","error","calculateTotalPrice","cartDataString","cartData","productIds","totalPrice","result","updateTotalPrice","totalPriceSpan","total","data","cartList","removeProduct","event","cartEl","removeBtn","none","removeFromCart","updateCartCounterOnLoad","initCartStorage","cartProductsList","cartsTotal","form","senndForm","emailOut","order","findproduct","item","sendFormData","serverUrl","formData","axios","response","openCardPageModal","emailFInput","onSubmit"],"mappings":"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"}